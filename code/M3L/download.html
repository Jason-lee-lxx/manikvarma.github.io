<html>

<head>
  <title>M3L Code for Efficient Max-Margin Multi-Label Classification</title>
  <meta name="keyword" content="M3L, Multi Label Classification, Multi
  Label, Classification"> 
</head>

<body>
<center>
  <h1><b>M3L: Efficient Max-Margin Multi-Label Classification</b></h1>
</center>


<p> 
The objective in multi-label classification is to tag a data point
with a <i>set</i> of relevant labels. Given a set of <i>L</i> labels,
a data point can be tagged with any of the 2<sup><i>L</i></sup>
possible subsets. The main challenge therefore lies in optimising over
this exponentially large label space subject to label correlations.
</p>

<p>
The following is efficient code for learning a max-margin multi-label
classifier. The code implements the <a href="#TR10">M3L
algorithm</a> and the problem formulation, optimisation details and
run times on benchmark datasets can be found in the paper.  The code
contains specialised algorithms for the kernelised and the linear
cases. The code is very efficient at learning 1-vs-All SVMs as it
re-utilises the kernel cache. We were able to train on the RCV1 dataset
(23K training data points, 47K dimensional sparse features and 103
labels) using an RBF kernel in 817 seconds while training in a
1-vs-All fashion using LIBSVM took 5600 seconds. For the linear case,
we were able to train on RCV1 with nearly a million training points in
18 minutes using a single core of an 2.66 GHz Xeon processor (we had
more or less reached the global optimum within 6 minutes). The
algorithm learns label correlations present in the training dataset
but prior knowledge about how labels are correlated can also be
incorporated.
</p>

</p>
<a href="M3L.zip"><h3> Download source code and Windows/Linux binaries</h3></a>
</p>

<p>
The code is in C++ and should compile on 32/64 bit Windows/Linux
machines. Please set "#define WINDOWS 1" in "include/definitions.h"
when compiling on Windows machines (see the included README.txt). This
code is made available as is for non-commercial research purposes.
</p>

<p>
<h2>Usage</h2>
</p>

<p>
<b>Training</b>: The command<br>
<tt>M3L -train [options] training_file model_file</tt></br>
reads in training data from <tt>training_file</tt> and saves the
learnt M3L classifier in <tt>model_file</tt> subject to the following options

<ul>
<li>-C misclassification penalty. Default 0.5</li>
<li>-a optimisation algorithm:
	<ul>
	<li>0: Kernelised -- SMO (Default) </li>
	<li>1: Linear -- Dual co-ordinate ascent with shrinkage
		      (choose this if you have a linear kernel)</li>
	</ul></li>
<li>-t tau. Stopping parameter. Algorithm stops when all projected gradients have magnitude less than tau. Default 0.001</li>
<li>-k kernel type (valid only with -a 0).
	<ul>
	 <li>0: Linear: x'*y</li>
	 <li>1: RBF: exp(-gamma*||x-y||^2) (Default)</li>
	 <li>2: Polynomial: (gamma*x'*y+u_0)^degree</li>
	</ul></li>
<li>-g gamma (kernel parameter for RBF and Polynomial kernels). Default 1</li>
<li>-d degree. Default 3</li>
<li>-r u_0. Default 1</li>
<li>-b bias. Default 1</li>
<li>-m cache size in MB. Default 1000 (the best results are obtained
when the cache is large enough to hold the entire kernel matrix)</li>
<li>-R correlation matrix file. Look at example_R.txt for an example
correlation matrix file (Defaults to using the identity matrix).</li>
</ul>
</p>

<p>
<b>Testing</b>: The command<br>
<tt>M3L -test testing_file model_file output_file</tt><br>
applies the learnt M3L classifier in <tt>model_file</tt> to the test
data in <tt>testing_file</tt> and saves the predictions in
<tt>output_file</tt>. 
</p>

<p>
The training, testing, model and output prediction files all follow
the <a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/">LIBSVM</a>
file format.
</p>

<p>
<h2>Toy Example</h2>
</p>

<p>
A toy example has been included with the source code and
binaries. Unpack the code and try<br><br> <tt> > cd
toyexample</tt><br> <tt> > ../bin/OS/M3L -train -k 1 example_data.svm
your_example_model_kernel_withoutR.txt</tt><br><br> where OS can be
one of linux, linux64, windows or windowsx64. This trains the M3L
classifier with an RBF kernel on the toy data. No <i>a priori</i>
information about label correlations is provided. Compare your learnt
model to the one provided to make sure that there were no errors.
</p>

<p>
To incorporate the correlation matrix given in example_R.txt
try<br><br> 
<tt> > ../bin/OS/M3L  -train -k 1 -R example_R.txt example_data.svm your_example_model_kernel_withR.txt</tt><br><br>

Results for the linear kernel can be generated by<br><br>
<tt>> ../bin/OS/M3L  -train -a 1 example_data.svm your_example_model_linear_withoutR.txt</tt></br></br>
</p>
<p>
Outputs on the test file example_test.svm can be generated by<br><br>
<tt>> ../bin/OS/M3L -test example_test.svm your_example_model_linear_withoutR.txt your_example_output_linear_withoutR.txt</tt>
</p>
<p>
The Hamming Loss that should be obtained is as follows:<br><br>
<tt>Hamming Loss for label 0 : 14.000002%</tt><br>	
<tt>Hamming Loss for label 1 : 1.000000%</tt><br>
<tt>Net Hamming Loss: 7.500000%</tt>
</p>
<p>
Please go through the included README and the reference below for
details. 
</p>


<h2> References </h2>
<ul type="circle">

  <a name="MLJ12">
  <li>
    B. Hariharan, S. V. N. Vishwanathan and M. Varma.
    <b> Efficient max-margin multi-label classification with applications to zero-shot learning. </b> 
    <i> Machine Learning Journal</i>, , 88(1):127--155, 2012. 
    <br>
    <a href="..\..\pubs\selfbib.html#Hariharan12">Bibtex source</a> | 
    <a href="..\..\pubs\hariharan12-abstract.txt" target="_blank">Abstract</a> | 
    Download in <a href="..\..\pubs\hariharan12.pdf">pdf</a> format
  </li>
  <br><br>

  <a name="ICML10">
  <li>
    B. Hariharan, L. Zelnik-Manor, S. V. N. Vishwanathan and M. Varma.
    <b> Large scale max-margin multi-label classification with
    priors. </b> 
    In <i> Proceedings of the International Conference on Machine
    Learning, Haifa, Israel</i>, June 2010.
    <br>
    <a href="..\..\pubs\selfbib.html#Hariharan10">Bibtex source</a> | 
    <a href="..\..\pubs\hariharan10-abstract.txt"
    target="_blank">Abstract</a> | 
    Download in <a href="..\..\pubs\hariharan10.pdf">pdf</a> format
  </li>
  <br><br>

  <a name="ICML10Proof">
  <li>
    B. Hariharan, L. Zelnik-Manor, S. V. N. Vishwanathan and M. Varma.
    <b> Proof of convergence of the M3L algorithm. </b> 
    <br>
    Download in <a href="proof.pdf">pdf</a> format
  </li>
  <br><br>
</ul>

<a href="../../index.html#ICML10">Home Page</a>

<table height="72%">
  <tr valign="bottom">
    <td> &nbsp </td>
  </tr>
</table>

</body>

</html>


